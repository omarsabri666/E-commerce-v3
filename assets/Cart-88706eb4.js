import{a as b,u as h,c as m,j as e,T as C,f as p,d as j,D as y,Q as c,e as w,U as v,g as N,h as k,L as u,i as L,k as Q}from"./index-3b5932f4.js";function D({item:t}){const o=b(),l=h();async function i(){if(t.count===1)return s();d(t.count-1)}const{mutate:s,isLoading:n}=m({mutationFn:()=>y(t.product.id),onSuccess:()=>{l.invalidateQueries({queryKey:["cart"]}),c.info("item was deleted")},onError:()=>{c.error("could not delete item")}}),{mutate:d,isLoading:a}=m({mutationFn:x=>w(x,t.product.id),onSuccess:()=>{l.invalidateQueries({queryKey:["cart"]})},onError:()=>{}});return e.jsxs("div",{className:" flex flex-row   justify-around items-center",children:[e.jsxs("div",{onClick:()=>o(`/productDetails/${t.product.id}`),className:"  items-center  cursor-pointer flex-wrap flex   md:gap-10",children:[e.jsx("img",{src:t.product.imageCover,className:"  md:w-40 md:h-40 rounded-lg shadow-sm  w-24 h-28",alt:`${t.product.title}img`}),e.jsx("div",{className:"      md:w-36  ",children:e.jsx("h2",{children:t.product.title})})]}),e.jsxs("div",{className:" space-x-3   flex items-center",children:[e.jsx("button",{"aria-label":"decrease item by 1",disabled:a,onClick:i,className:`text-2xl font-semibold text-center ${a?"cursor-progress":""}     text-white w-10 h-10   flex justify-center items-center p-0 m-0   disabled:opacity-50    rounded-full`,children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9.19993 10.8L9.26856 10.8H9.99993H10.3999L10.7999 10.8L16.3999 10.8C16.6121 10.8 16.8156 10.7157 16.9656 10.5657C17.1156 10.4157 17.1999 10.2122 17.1999 10C17.1999 9.78785 17.1156 9.58437 16.9656 9.43434C16.8156 9.28431 16.6121 9.20002 16.3999 9.20002H10.7999L10.5656 9.20003L9.99993 9.20002L9.43424 9.20002L9.19993 9.20003L3.59993 9.20002C3.38775 9.20002 3.18427 9.28431 3.03424 9.43434C2.88421 9.58437 2.79993 9.78785 2.79993 10C2.79993 10.2122 2.88421 10.4157 3.03424 10.5657C3.18427 10.7157 3.38775 10.8 3.59993 10.8L9.19993 10.8Z",fill:"black"})})}),e.jsx("span",{className:" font-semibold text-lg",children:a||n?e.jsx(C,{visible:!0,height:"24",width:"82",color:"black",secondaryColor:"black",ariaLabel:"oval-loading",wrapperStyle:{},wrapperClass:""}):t.count}),e.jsx("button",{"aria-label":"increase item by 1",disabled:a,onClick:()=>d(t.count+1),className:`text-2xl font-semibold text-center ${a?"cursor-progress":""}     text-white w-10 h-10   flex justify-center items-center p-0 m-0   disabled:opacity-50    rounded-full`,children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9.20005 16.4C9.20005 16.6122 9.28433 16.8157 9.43436 16.9657C9.58439 17.1157 9.78788 17.2 10 17.2C10.2122 17.2 10.4157 17.1157 10.5657 16.9657C10.7158 16.8157 10.8 16.6122 10.8 16.4V10.8H16.4C16.6122 10.8 16.8157 10.7157 16.9657 10.5657C17.1158 10.4157 17.2 10.2122 17.2 10C17.2 9.78784 17.1158 9.58436 16.9657 9.43433C16.8157 9.2843 16.6122 9.20002 16.4 9.20002H10.8V3.60002C10.8 3.38785 10.7158 3.18436 10.5657 3.03433C10.4157 2.8843 10.2122 2.80002 10 2.80002C9.78788 2.80002 9.58439 2.8843 9.43436 3.03433C9.28433 3.18436 9.20005 3.38785 9.20005 3.60002V9.20002H3.60005C3.38788 9.20002 3.18439 9.2843 3.03436 9.43433C2.88433 9.58436 2.80005 9.78784 2.80005 10C2.80005 10.2122 2.88433 10.4157 3.03436 10.5657C3.18439 10.7157 3.38788 10.8 3.60005 10.8H9.20005V16.4Z",fill:"black"})})})]}),e.jsx("h3",{className:" text-black font-bold",children:p(t.price*t.count)}),e.jsx("button",{"aria-label":"delete button",disabled:n,onClick:s,className:" text-black disabled:opacity-50 text-3xl",children:e.jsx(j,{})})]})}const I="/assets/empty-cart.17f48bd13327a233e04a-e032299f.webp";function q(){const t=h(),{setCart:o,cart:l,user:i}=v(),{data:s,isLoading:n,isRefetching:d,refetch:a}=N({queryFn:L,queryKey:["cart",l]},{enabled:!!i});async function x(){try{return(await Q.delete("/api/v1/cart",{headers:{token:localStorage.getItem("token")}})).data}catch(r){throw console.log(r.data),r}}const{mutate:f}=m({mutationFn:x,onSuccess:()=>{t.cancelQueries({queryKey:["cart"]}),t.invalidateQueries(["cart"]),c.info("cart was cleared"),a(),o(r=>!r)},onError:()=>{c.error("could not clear cart"),t.invalidateQueries(["cart"])},onSettled:()=>{t.invalidateQueries(["cart"])},onMutate:()=>{t.invalidateQueries(["cart"])}});return n?e.jsx("div",{className:" flex items-center justify-center",children:e.jsx(k,{})}):i?s!=null&&s.numOfCartItems?e.jsxs("div",{className:" max-w-6xl flex-col flex px-2 md:px-0   gap-6 mx-auto my-10",children:[s==null?void 0:s.data.products.map((r,g)=>e.jsx(D,{item:r},g)),e.jsxs("div",{className:" flex items-center justify-around my-5 gap-4",children:[e.jsxs("div",{className:" flex   items-center gap-4",children:[e.jsx("h2",{className:" font-bold text-lg",children:"Total Cart : "}),e.jsx("h3",{className:" text-black font-bold text-lg",children:p(s==null?void 0:s.data.totalCartPrice)})]}),e.jsxs("div",{className:"     flex-wrap  flex gap-2 ",children:[e.jsx("button",{onClick:f,className:" bg-red-600 text-center hover:bg-red-800  text-sm transition-all px-4 py-2  md:px-8 md:py-3 text-white font-semibold md:text-lg rounded-sm",children:"Clear Cart"}),e.jsx(u,{to:"/checkout",className:" hover:bg-black outline px-4 py-2 text-sm outline-black md:text-lg font-bold hover:text-white transition-all md:px-10 md:py-4 rounded-sm  text-black",children:"Check Out"})]})]})]}):e.jsxs("div",{className:" flex gap-2 flex-col items-center justify-center",children:[e.jsx("img",{src:I,alt:"empty cart img"}),e.jsx("h1",{className:" text-omar font-bold  text-3xl",children:"your cart is Empty"}),e.jsx(u,{className:" bg-black text-white px-6 py-2 rounded-xl my-4 font-semibold ",to:"/",children:"Keep Looking"})]}):e.jsxs("div",{className:" flex-col my-10 flex justify-center items-center",children:[e.jsx("h2",{className:"  text-3xl font-semibold",children:"You need to Sign in First"}),e.jsx(u,{className:" underline text-blue-600 text-2xl font-semibold",to:"/signin",children:"Sign in"})]})}export{q as default};
